---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Ana Golob"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE}
source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjiĹľnic
source("lib/libraries.r", encoding = "UTF-8")
```

### TEMA: Gospodarska razvitost slovenskih regij

Seminarska naloga analizira razvitost slovenskih regij glede na sledeče podatke iz področja gospodarstva:

* povprečna mesečna bruto plača prebivalca,

* število prebivalcev, ki so zaposleni,

* število podjetij, ki obratujejo v regiji,

* prihodek

* število domačih in tujih turistov, ki obiščejo regijo.

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source(c("uvoz/uvoz.r"), encoding = "UTF-8")
```

Vozili smo podatke o občinah v obliki csv iz Statističnega urada in iz Wikipedije. Podatke o občinah smo nato pretvorili v podatke o regijah.

```{r razpredelnice}
kable(head(regije))
head(regije)

kable(head(zdruzena1))
head(zdruzena1)

kable(head(zdruzena3))
head(zdruzena3)
```

Slika \ref{fig:histogram} prikazuje porazdelitev Ĺˇtevila naselij v obÄŤinah.

```{r histogram, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Histogram Ĺˇtevila naselij v obÄŤinah'}
#ggplot(obcine, aes(x = naselja)) + geom_histogram() +
#  ggtitle("Pogostost Ĺˇtevila naselij") + xlab("Ĺ tevilo naselij") + ylab("Ĺ tevilo obÄŤin")
```

***

# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE}
#source("vizualizacija/vizualizacija.r", encoding = "UTF-8")
```

Slika \ref{fig:zemljevid} prikazuje povpreÄŤno velikost druĹľine za vsako obÄŤino.

```{r zemljevid, echo=FALSE, fig.align='center', fig.cap='Zemljevid povpreÄŤnega Ĺˇtevila otrok v druĹľini'}
#ggplot() + geom_polygon(data = left_join(zemljevid, povprecja, by = c("OB_UIME" = "obcina")),
#                        aes(x = long, y = lat, group = group, fill = povprecje)) +
#  ggtitle("PovpreÄŤno Ĺˇtevilo otrok v druĹľini") + xlab("") + ylab("") +
#  guides(fill = guide_colorbar(title = "PovpreÄŤje"))
```

***

# Napredna analiza podatkov

```{r analiza, echo=FALSE, message=FALSE}
#source("analiza/analiza.r", encoding = "UTF-8")
```

Slika \ref{fig:graf} prikazuje povezavo med Ĺˇtevilom naselij in povrĹˇino obÄŤine.

```{r graf, echo=FALSE, fig.align='center', fig.cap='Povezava med Ĺˇtevilom naselij in povrĹˇino obÄŤine'}
#ggplot(inner_join(obcine, data.frame(obcina = names(skupine),
#                                     skupina = factor(skupine)), by = "obcina")
#, aes(x = povrsina, y = naselja, color = skupina, size = prebivalci/1000)) + geom_point() +
#  ggtitle("Ĺ tevilo naselij glede na povrĹˇino obÄŤine") +
#  xlab(expression("PovrĹˇina (km"^2 * ")")) + ylab("Ĺ t. naselij") +
#  guides(color = guide_legend(title = "Skupina"),
#         size = guide_legend(title = "Prebivalci (* 1000)"))
```

***

```{r shiny, echo = FALSE}
#shinyAppDir("shiny", options=list(width="100%", height=600))
```
